<?xml version="1.0" encoding="iso-8859-1" ?>

<table>
  <base>CRM/Funding</base>
  <class>FundingFormStringTranslation</class>
  <name>civicrm_funding_form_string_translation</name>
  <log>true</log>

  <field>
    <name>id</name>
    <type>int unsigned</type>
    <required>true</required>
    <comment>Unique FundingFormStringTranslation ID</comment>
    <html>
      <type>Number</type>
    </html>
  </field>
  <primaryKey>
    <name>id</name>
    <autoincrement>true</autoincrement>
  </primaryKey>

  <field>
    <name>funding_program_id</name>
    <type>int unsigned</type>
    <required>true</required>
    <title>Funding Program</title>
    <comment>FK to FundingProgram</comment>
    <html>
      <type>EntityRef</type>
    </html>
    <pseudoconstant>
      <table>civicrm_funding_program</table>
      <keyColumn>id</keyColumn>
      <labelColumn>title</labelColumn>
      <prefetch>false</prefetch>
    </pseudoconstant>
  </field>
  <foreignKey>
    <name>funding_program_id</name>
    <table>civicrm_funding_program</table>
    <key>id</key>
    <onDelete>CASCADE</onDelete>
  </foreignKey>

  <field>
    <name>funding_case_type_id</name>
    <type>int unsigned</type>
    <required>true</required>
    <title>Funding Case Type</title>
    <comment>FK to FundingCaseType</comment>
    <html>
      <type>EntityRef</type>
    </html>
    <pseudoconstant>
      <table>civicrm_funding_case_type</table>
      <keyColumn>id</keyColumn>
      <labelColumn>title</labelColumn>
      <prefetch>false</prefetch>
    </pseudoconstant>
  </field>
  <foreignKey>
    <name>funding_case_type_id</name>
    <table>civicrm_funding_case_type</table>
    <key>id</key>
    <onDelete>CASCADE</onDelete>
  </foreignKey>

  <field>
    <!--
      The field name is chosen to be skipped in \CRM_Utils_API_HTMLInputCoder,
      see \CRM_Utils_API_HTMLInputCoder::getSkipFields().
    -->
    <name>msg_text</name>
    <title>Original</title>
    <!--
      We need a collation that is accent-sensitive and case-sensitive. However, the
      chosen collation utf8mb4_bin doesn't sort in natural order. Collations
      that are also sorting in natural order are named differently on MariaDB
      and MySQL, though. (MariaDB: utf8mb4_0900_as_cs, MySQL:
      utf8mb4_0900_as_cs) Since MariaDB 11.4.5 there's a mapping of MySQL
      collations: https://jira.mariadb.org/browse/MDEV-20912.
    -->
    <type>varchar(8000) COLLATE utf8mb4_bin</type>
    <length>8000</length>
    <crmType>CRM_Utils_Type::T_STRING</crmType>
    <required>true</required>
    <comment>Original</comment>
    <html>
      <type>TextArea</type>
    </html>
  </field>

  <field>
    <!--
      The field name is chosen to be skipped in \CRM_Utils_API_HTMLInputCoder,
      see \CRM_Utils_API_HTMLInputCoder::getSkipFields().
    -->
    <name>new_text</name>
    <title>Translation</title>
    <!--
      Because this field is marked as not required CiviCRM adds NULL to the type
      in the SQL code, resulting in "varchar(8000) NOT NULL". So NULL is not
      allowed by the schema and at the same time the empty string may be used in
      SearchKit's in-place edit.

      For the collation see comment on msg_text.
    -->
    <type>varchar(8000) COLLATE utf8mb4_bin NOT</type>
    <length>8000</length>
    <crmType>CRM_Utils_Type::T_STRING</crmType>
    <required>false</required>
    <comment>Translation</comment>
    <html>
      <type>TextArea</type>
    </html>
  </field>

  <field>
    <name>modification_date</name>
    <type>timestamp ON UPDATE CURRENT_TIMESTAMP</type>
    <crmType>CRM_Utils_Type::T_TIMESTAMP</crmType>
    <required>false</required>
    <html>
      <type>Select Date</type>
      <formatType>activityDateTime</formatType>
    </html>
  </field>

  <index>
    <name>UI_translation</name>
    <fieldName>funding_program_id</fieldName>
    <fieldName>funding_case_type_id</fieldName>
    <fieldName>msg_text</fieldName>
    <unique>true</unique>
  </index>

  <paths>
    <update>civicrm/funding/funding/form-string-translation/edit#?FundingFormStringTranslation1=[id]</update>
  </paths>

</table>
